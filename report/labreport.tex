\documentclass[10pt,a4paper]{labreport}
\usepackage{csquotes}
\usepackage{titlesec}
\usepackage{ragged2e}
\usepackage{siunitx}
\usepackage{setspace}
\usepackage{longtable}
\usepackage{rotating}
\usepackage{xurl}
\usepackage{physics}
\usepackage{caption}
\usepackage{wrapfig}
\usepackage{tabularray}
\usepackage{fancyhdr}
\usepackage{subcaption}
\usepackage{lscape}
\usepackage{tensor}
\usepackage{multirow}
\usepackage{chemformula}
\usepackage[gen]{eurosym}
\usepackage{float}
\usepackage{bm}
\usepackage{lipsum}
\usepackage{parskip}
\usepackage{booktabs}
\usepackage{enumerate}
\usepackage[justification=justified]{caption}
\usepackage[nottoc]{tocbibind}
\usepackage{hyperref}
%  \usepackage[
% backend=biber,
% style=chem-acs,articletitle=true,doi=true]{biblatex}
% %\addbibresource{references.bib}





\title{Nanoscale Material Modelling
\\
\normalsize{Week 1}} % Main title and sub title. 

\author{Ilija A. GjerapiÄ‡, S4437586; \href{mailto:i.a.gjerapic@student.rug.nl}{i.a.gjerapic@student.rug.nl}; \href{https://github.com/igjerapic/nmm-week1/}{@github} } % Name, student number, email

\supervisors{prof. dr. A. Giuntoli, prof. dr. J. Slawinska}

\begin{document}


\maketitle



  

\thispagestyle{firststyle}
\newpage
\section{Assignment 1: DFT calculation of WTe2 monolayer}
Self-consistant field calculation
\begin{itemize}
    \item Bravais lattice is rectangular: The two W atoms (grey balls) do not lie in the x-y plane, but have an angle of 4.27deg between them. Makes sense due to {\color{red} MATCHING WITH REFERENCES}
  
    \item Supercell constructed using the Cell dimensions ?Flag? with dimensions 3.5 x 6.28 x 30 \AA. 
    \item Distance between monolayers is 30 \AA, as expected from supercell
    \item Running for 3 minutes showed approx 40 seconds per iteration. The run time was then set to 30 minutes assuming that it would take max 15 iterations each of 1 min long. 
  \end{itemize}

  Band structure
  \begin{itemize}
    \item No nscf was necessary as the kpoints were interpolated with gaussian smearing
    \item Show image of points taken using xcrysden
    \item for plotting check out \url{https://github.com/quantumNerd/Quantum-Espresso-Tutorial-2019-Projects/tree/master/tools/plot_band} 
  \end{itemize}
  The visualization of the \texttt{Si.sci.in} input file is shown in Figure \ref{fig:ass1_cryst}. 
  \begin{figure}[h]
    \centering 
    \includegraphics[width = 0.7\textwidth]{example-image-a}
    \caption{\textbf{(a)} The conventional FCC unit cell with a two atom basis. The lattice constant was found to be 5.43 \AA. with a bond angle of 90$^\circ$. (b) The primitive unit cell obtained from the input file. A lattice constant of 3.8396 {\AA} was found, with a bond angle of 60$^\circ$.}
    \label{fig:ass1_cryst}
  \end{figure}

\newpage
\section{Assignment 2: Graphene}
\begin{itemize}
  \item graphene supercell using graphite structure from week2
  \item Use xcrysden to inspect it
  \item band structure along M-G-K-M direction. Compare with literature 
\end{itemize}


\section{Assignment 3: Gr/WTe2 Heterostructure}
3a)
\begin{itemize}
  \item Analysis of wte2-gr.relax.in file
  \item Analysis of respective structure:
  \begin{itemize}
    \item hexagonal or rectangular: 
    
    Was found to be rectangular 
    \item twisting angle
    \item number of graphene unit cells
  \end{itemize}
\end{itemize}

3b)
\begin{itemize}
  \item Use own files for graphene and WTe2 monolayers to create heterostructure yourself
  \item Open files using xcrysden and save as xsf. Then check out \url{https://www.youtube.com/watch?v=vAc_vlSfQT0} to generate heterostructure 
\end{itemize}


The thermodynamic data for the system ran at a temperature of 1.0 and a packing fraction of 0.45 is shown in Figure \ref{fig:ass3_thermo}. As all parameters are relatively stable over the simulation, it can be said that the system is in equilibrium. 

\begin{figure}[htpb]
  \centering 
  \includegraphics[width = 0.9\textwidth]{figs/ass3_thermo.png}
  \caption{The thermodynamic data over time as extracted from the \texttt{log.lammps} file for a system at temperature $T=1.0$ and packing fraction \texttt{eta=0.45}. (a) is the temperature of the system, (b) the pressure of the system, and (c) the Kinetic and potential energy of the system.}
  \label{fig:ass3_thermo}
\end{figure}

The effect of different temperatures and packing fractions on the structure and dynamics of the system are demonstrated in Figures \ref{fig:ass3_struc} and \ref{fig:ass3_rdf-msd}. 
The structural visualization using the \texttt{Common neighbor} analysis in \texttt{Ovito}, Figure \ref{fig:ass3_struc} suggests that for a packing fraction of 0.45, there is no crystalization and that the systems are liquid. This is supported by the RDFs of these systems, Fig \ref{fig:ass3_rdf-msd}(a), demonstrating a large peak at $r/\sigma = 1$ followed by smaller decaying peaks. However, it is noted that the MSD of T0.5-eta0.45, Figure \ref{fig:ass3_rdf-msd}(b) shows an inflection point and short plateau starting at $\tau\approx 1.0$, followed by a super diffusive regime, which is characteristic of glassy/caging dynamics.  

Additionally, for packing fractions of 0.6 and 0.7 at temperature 1.0 show crystal domains mainly of HCP and FCC structure. This is also supported by the sharp peaks observed in the corresponding RDFs, Figure \ref{fig:ass3_rdf-msd}(c). Moreover, both MSDs for eta=0.6,0.7, Figure \ref{fig:ass3_rdf-msd}(d) show a strong plateau after the ballistic regime, which is indicative of a solid like material. 

\begin{figure}[htpb]
  \centering 
  \includegraphics[width = 0.6\textwidth]{figs/ass3_struct.pdf}
  \caption{Visualizations of the varied parameters for the simple LAMMPS system. (Top) Varying the temperature $T$ for a constant packing fraction \texttt{eta}. (Middle) The color scheme for the structure offered by the \texttt{Common neighbor} analysis in \texttt{Ovito}. (Bottom) Various packing fractions for a constant temperature $T$. }
  \label{fig:ass3_struc}
\end{figure}
\begin{figure}[htpb]
  \centering 
  \includegraphics[width = 0.8\textwidth]{figs/ass3_rdf-msd.pdf}
  \caption{The RDF and MSD for the samples in Figure \ref{fig:ass3_struc}. (a-b) correspond to a fixed packing fraction of 0.45 while (c-d) correspond to a fixed temperature of 1.0. For the fixed packing fraction, all systems show a liquid characteristic, with glassy behavior emerging at T=0.5. Increasing packing fraction leads to a crystal grains, with more regular packing showing for a packing fraction of 0.6. }
  \label{fig:ass3_rdf-msd}
\end{figure}

\section{Assignment 4: Benchmarking}

\begin{enumerate}
  \item Benchmarking Quantum Espresso DFT calculation
  
  \begin{table}[h]
    \caption{An overview of the total wall time in seconds for different number of processors used on the parallel partition on Habrok for 4 and 16 k-points (nk). For each simulation \texttt{ecutwfc=40.0 Ry}, \texttt{conv\_thr=1d-8} was used. Each simulation provided the same lattice constant as mentioned in Figure \ref{fig:ass1_cryst}(b), within the limit provided by \texttt{xcrysden}. From Figure \ref{fig:ass2_energy-ecut_nks}(a), the accuracy in final energy increased the most when moving to \texttt{nk=4}, thus, extra parallelization here is not optimal: the calculation using 12 processors and \texttt{nk=4} is most optimal. }
    \label{tab:ass4_DFT-benchmark}
    \centering
    \begin{tabular}{c|ccc}
      \hline
      \multirow{2}{*}{nk} & \multicolumn{3}{c}{Number Processors} \\
                          & 2           & 12         & 64         \\ \hline
      4                   & 0.89        & 0.63       & 0.53       \\
      16                  & 17.34       & 9.93       & 2.90       \\ \hline
      \end{tabular}
  \end{table}

\item Benchmarking LAMMPS MD Simulations

\begin{table}[htbp]
  \caption{The performance of the LAMMPS simulation of 4096 particles with one task per node for increasing cut-off distances of the LJ potential.}
  \label{tab:ass4_lammps-lj}
  \centering
  \begin{tabular}{cc} \hline
    \textbf{\texttt{lj\_cut}} $\bm{\sigma}$ & \textbf{Performance (steps/s)}\\
    \hline
    1.12                        & 1260.628                        \\
    2.0                         & 450.479                         \\
    4.0                         & 90.332                          \\
    6.0                         & 32.678                          \\ \hline
    \end{tabular}
\end{table}

\begin{table}[htbp]
  \caption{The performance of the LAMMPS simulation of 4096 particles with one task per node for increasing cut-off distances of the \texttt{lj/cut/coul/cut} potential. \texttt{lj\_cut} was kept at 1.12 $\sigma$. Each particle had a charge of +1.}
  \label{tab:ass4_lammps-coul}
  \centering
  \begin{tabular}{cc} \hline
    \textbf{\texttt{coul\_cut}} $\bm{\sigma}$ & \textbf{Performance (steps/s)}\\
    \hline
    1.12                        & 1226.768                        \\
    2.0                         & 398.870                        \\
    4.0                         & 80.435                          \\
    6.0                         & 29.116                          \\ \hline
    \end{tabular}
\end{table}

\begin{table}[htb]
  \caption{The performance of the LAMMPS simulation of $N$ particles with one task per node for \texttt{lj/cut} interactions with a cut-off distances of 1.12 $\sigma$ and \texttt{lj/cut/coul/cut} interactions with cut-off distances of 1.12 and 6.0 $\sigma$. For the \texttt{lj/cut/coul/cut} interactions, each particle had a charge of +1.}
  \label{tab:ass4_lammps-npart}
  \centering
  \begin{tabular}{ccc} \hline
    \textbf{\texttt{N}} & \textbf{steps/s (lj/cut) }& \textbf{steps/s (lj/cut/coul/cut)}\\
    \hline
    4096                        & 1260.628      &       29.116           \\
    8192                         & 627.877       &      14.173           \\
    12288                         & 419.067      &      9.787              \\
    16384                         & 297.377       &     7.012              \\ \hline
    \end{tabular}
\end{table}

\begin{table}[htb]
  \caption{The performance of the LAMMPS simulation of 4096 particles with $M$ tasks per node (processors) for \texttt{lj/cut} interactions with a cut-off distances of 1.12 $\sigma$ and \texttt{lj/cut/coul/cut} interactions with cut-off distances of 1.12 and 6.0 $\sigma$. For the \texttt{lj/cut/coul/cut} interactions, each particle had a charge of +1. 
  Comparing the performance values to those obtained in the first row of Table \ref{tab:ass4_lammps-lj} and last row of Table \ref{tab:ass4_lammps-coul}, shows that parallelization of LAMMPS on Habrok can lead to substantial increases in efficiency.}
  \label{tab:ass4_lammps-nproc}
  \centering
  \begin{tabular}{ccc} \hline
    \textbf{\texttt{M}} & \textbf{steps/s (lj/cut) }& \textbf{steps/s (lj/cut/coul/cut)}\\
    \hline
    2                        & 2449.352      &       57.569          \\
    4                         & 4124.183       &      111.287           \\
    8                         & 6796.371      &      196.499              \\
    16                         & 10838.676      &     417.952              \\ 
    32                        &  9851.291        &  604.731\\ \hline
    \end{tabular}
\end{table}
\end{enumerate}

\newpage
% \printbibliography

% \begin{appendices}
%   \input{Appendix}
% \end{appendices}

\end{document}



